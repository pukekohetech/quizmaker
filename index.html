<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1b3a57">
  <!-- Manifest for installable PWA -->
  <link rel="manifest" href="manifest.json">
  <title>Quiz JSON Builder – BCATS Safety Assessments</title>
  <!-- External stylesheet -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <h1>Quiz JSON Builder – BCATS Safety Assessments</h1>

  <!-- Top controls -->
  <div class="controls">
    <input type="file" id="jsonFile" accept="application/json">
    <button type="button" onclick="loadJSONFile()">Load JSON File</button>
    <button type="button" onclick="clearDraft()">Clear Draft</button>
    <button type="button" class="secondary-btn" onclick="expandAllSections()">Expand all assessments &amp; questions</button>
    <button type="button" class="secondary-btn" onclick="collapseAllSections()">Collapse all assessments &amp; questions</button>
    <button type="button" onclick="generateJSON()">Download JSON File</button>
    <!-- The jump-to-question dropdown and dark mode button will be injected by the script -->
  </div>

  <!-- General information section -->
  <div class="section collapsed">
    <div class="section-header">
      <button type="button" class="collapse-btn" onclick="toggleSectionCollapse(this)">▸</button>
      <span class="section-header-title">General Information</span>
    </div>
    <div class="section-body">
      <label>APP_ID <input type="text" id="appId" value="US24352_SAFETY"></label>
      <label>VERSION <input type="text" id="version" value="2025"></label>
      <label>APP_TITLE <input type="text" id="appTitle" value="US 24352 – Safety Knowledge"></label>
      <label>APP_SUBTITLE <input type="text" id="appSubtitle" value="PHS - L1 Building – Assessment"></label>
      <label>Deadline Day <input type="number" id="deadlineDay" value="17"></label>
      <label>Deadline Month <input type="number" id="deadlineMonth" value="12"></label>
      <label>Deadline Label <input type="text" id="deadlineLabel" value="Submission deadline"></label>
    </div>
  </div>

  <!-- Teachers section -->
  <div class="section collapsed">
    <div class="section-header">
      <button type="button" class="collapse-btn" onclick="toggleSectionCollapse(this)">▸</button>
      <span class="section-header-title">Teachers</span>
    </div>
    <div class="section-body">
      <div id="teachers"></div>
      <button type="button" class="add-btn" onclick="addTeacher()">+ Add Teacher</button>
    </div>
  </div>

  <!-- Assessments container -->
  <div class="section">
    <h2>Assessments</h2>
    <div id="assessments"></div>
    <button type="button" class="add-btn" onclick="addAssessment()">+ Add Assessment</button>
  </div>

  <!-- Application script -->
  <script src="script.js" defer></script>
  <script>
    // Register the service worker when the page loads
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js').catch(err => console.log('Service worker registration failed:', err));
      });
    }
  </script>
</body>
</html>